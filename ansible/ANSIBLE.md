## Using custom role to install Docker

Please note that this is my first time using the galaxy template role, so several components have not been changed, their status is just ok.

```bash
➜ ansible git:(lab-5) ✗ ansible-playbook playbooks/dev/main.yaml --diff

PLAY [Dev] *******************************************************************************************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************************************************************************************************************************************************************************************************
[WARNING]: Platform linux on host compute-vm-2-2-20-ssd-1739256675625 is using the discovered Python interpreter at /usr/bin/python3.12, but future installation of another Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-
core/2.18/reference_appendices/interpreter_discovery.html for more information.
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Install Docker] ***********************************************************************************************************************************************************************************************************************************************************************************************
included: /Users/flake/Studying/devops/S25-core-course-labs/ansible/roles/docker/tasks/install_docker.yaml for compute-vm-2-2-20-ssd-1739256675625

TASK [docker : Install required system packages] *****************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Add Docker GPG key] *******************************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Add Docker repository] ****************************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Install Docker] ***********************************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Ensure Docker service is running and enabled] *****************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Add user to Docker group] *************************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Disable root access] ******************************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Install Docker Compose] ***************************************************************************************************************************************************************************************************************************************************************************************
included: /Users/flake/Studying/devops/S25-core-course-labs/ansible/roles/docker/tasks/install_docker_compose.yaml for compute-vm-2-2-20-ssd-1739256675625

TASK [docker : Download Docker Compose] **************************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Verify Docker Compose installation] ***************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Display installed Docker Compose version] *********************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625] => {
    "msg": "Docker Compose version v2.32.4"
}

PLAY RECAP *******************************************************************************************************************************************************************************************************************************************************************************************************************
compute-vm-2-2-20-ssd-1739256675625 : ok=13   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

```

## Inventory details

```bash
➜ ansible-inventory -i inventory/default_yc.yaml --list
{
    "_meta": {
        "hostvars": {
            "compute-vm-2-2-20-ssd-1739256675625": {
                "ansible_host": "51.250.69.125",
                "ansible_user": "flake"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped"
        ]
    },
    "ungrouped": {
        "hosts": [
            "compute-vm-2-2-20-ssd-1739256675625"
        ]
    }
}
```

## Run playbook with web application
```bash
➜ ansible ✗ ansible-playbook -i inventory/default_yc.yaml playbooks/dev/app_python/main.yaml     

PLAY [Deploy Python app] ******************************************************************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ********************************************************************************************************************************************************************************************************************************************************************************************
[WARNING]: Platform linux on host compute-vm-2-2-20-ssd-1739256675625 is using the discovered Python interpreter at /usr/bin/python3.12, but future installation of another Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-
core/2.18/reference_appendices/interpreter_discovery.html for more information.
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Install Docker] ************************************************************************************************************************************************************************************************************************************************************************************
included: /Users/flake/Studying/devops/S25-core-course-labs/ansible/roles/docker/tasks/install_docker.yaml for compute-vm-2-2-20-ssd-1739256675625

TASK [docker : Install required system packages] ******************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Add Docker GPG key] ********************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Add Docker repository] *****************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Install Docker] ************************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Ensure Docker service is running and enabled] ******************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Add user to Docker group] **************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Disable root access] *******************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Install Docker Compose] ****************************************************************************************************************************************************************************************************************************************************************************
included: /Users/flake/Studying/devops/S25-core-course-labs/ansible/roles/docker/tasks/install_docker_compose.yaml for compute-vm-2-2-20-ssd-1739256675625

TASK [docker : Download Docker Compose] ***************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Verify Docker Compose installation] ****************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [docker : Display installed Docker Compose version] **********************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625] => {
    "msg": "Docker Compose version v2.32.4"
}

TASK [web_app : Deploy App] ***************************************************************************************************************************************************************************************************************************************************************************************
included: /Users/flake/Studying/devops/S25-core-course-labs/ansible/roles/web_app/tasks/deploy_app.yaml for compute-vm-2-2-20-ssd-1739256675625

TASK [web_app : Pull Docker image] ********************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [web_app : Start container] **********************************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [web_app : Create directory for docker-compose file] *********************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [web_app : Deploy docker-compose file] ***********************************************************************************************************************************************************************************************************************************************************************
ok: [compute-vm-2-2-20-ssd-1739256675625]

TASK [web_app : Remove container] *********************************************************************************************************************************************************************************************************************************************************************************
skipping: [compute-vm-2-2-20-ssd-1739256675625]

TASK [web_app : Remove docker-compose file] ***********************************************************************************************************************************************************************************************************************************************************************
skipping: [compute-vm-2-2-20-ssd-1739256675625]

PLAY RECAP ********************************************************************************************************************************************************************************************************************************************************************************************************
compute-vm-2-2-20-ssd-1739256675625 : ok=18   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
```